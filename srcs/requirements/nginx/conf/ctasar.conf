# HTTPS için temel sunucu bloğu
server {
    # SSL üzerinden IPv4 ve IPv6 bağlantılarını dinle
    listen 443 ssl;
    listen [::]:443 ssl;

    # Sunucu adı - bu alan adına gelen istekler işlenecek
    server_name ctasar.42.fr;

    # SSL sertifikası ve özel anahtar konumları
    ssl_certificate     /etc/ssl/certs/ssl.crt;
    ssl_certificate_key /etc/ssl/private/ssl.key;

    # Sadece TLS 1.3'ü kullan - daha eski, güvensiz protokolleri devre dışı bırak
    ssl_protocols       TLSv1.3;

    # Varsayılan dosya olarak index.php'yi kullan
    index index.php;
    # WordPress dosyaları için kök dizin
    root  /var/www/html;

    # PHP dosyaları için özel konum yapılandırması
    location ~ [^/]\.php(/|$) {
        # Dosyanın var olup olmadığını kontrol et
        try_files         $uri =404;
        # PHP isteklerini WordPress konteynerine yönlendir (port 9000)
        fastcgi_pass      wordpress:9000;
        # FastCGI için standart parametreleri dahil et
        include           fastcgi_params;
        # PHP betiği için tam dosya yolunu belirt
        fastcgi_param     SCRIPT_FILENAME $document_root$fastcgi_script_name;
    }
}